// Assume that the standard basis refers to the polynomials: 1, x, ..., x^n.

// Set dimension of the polynomial subspace on to which we project the function.
// This is also the degree of the final approximation plus one.
var dimension = 8;
// Set the number of steps the numeric integration performs.
// This makes the final approximation more accurate.
var steps = 1e3;
// Set the bounds in which the approximation will be valid.
// These are also the bounds of integration for the inner product.
var lowerBound = -1,
    upperBound = 1;

class Vector {

  constructor(coordinates) {
    this.coordinates = coordinates;
  }

  toString(precision = 0) {
    var string, i;
    if (precision == 0) {
      string = "(";
      for (i = 0; i < this.coordinates.length - 1; i++) {
        string += this.coordinates[i] + ", ";
      }
      return string + this.coordinates[this.coordinates.length - 1] + ")";
    }
    else {
      string = "";
      for (i = 0; i < this.coordinates.length; i++) {
        string += (this.coordinates[i] == 0 ? 0 : this.coordinates[i].toFixed(precision)) + "x^{" + i + "}";
        if (i < this.coordinates.length - 1) {
          string += " + ";
        }
      }
      return string;
    }
  }
  
  clone() {
    return new Vector(this.coordinates.slice());
  }

  magSquared() {
    var p = polynomial(this.coordinates);
    return inner(p, p);
  }

  getNormalized() {
    return this.getScaled(1 / (this.magSquared() ** 0.5));
  }

  toPolynomial() {
    return polynomial(this.coordinates);
  }

  add(other) {
    for (var i = 0; i < this.coordinates.length; i++) {
      this.coordinates[i] += other.coordinates[i];
    }
  }
  getAdded(other) {
    var vector = this.clone(), i;
    for (i = 0; i < vector.coordinates.length; i++) {
      vector.coordinates[i] += other.coordinates[i];
    }
    return vector;
  }

  scale(c) {
    for (var i = 0; i < this.coordinates.length; i++) {
      this.coordinates[i] *= c;
    }
  }
  getScaled(c) {
    var vector = this.clone(), i;
    for (i = 0; i < vector.coordinates.length; i++) {
      vector.coordinates[i] *= c;
    }
    return vector;
  }
  
}

function polynomial(coordinates) {
  return (x) => {
    var total = 0, i;
    for (i = 0; i < coordinates.length; i++) {
      total += coordinates[i] * Math.pow(x, i);
    }
    return total;
  };
}

function integral(low, high, f) {
  var total = 0, i;
  for (i = 0; i < steps; i++) {
    total += f( (high-low) * i/steps + low );
  }
  return total / steps;
}

function inner(p, q) {
  return integral(lowerBound, upperBound, (x) => p(x)*q(x));
}

function vectorInner(vec1, vec2) {
  return inner(vec1.toPolynomial(), vec2.toPolynomial());
}

function getStandardBasis() {
  var basis = [], vector, i, j;
  for (i = 0; i < dimension; i++) {
    vector = [];
    for (j = 0; j < dimension; j++) {
      vector.push(i == j ? 1 : 0);
    }
    basis.push(new Vector(vector));
  }
  return basis;
}

function orthonormalize(basis) {
  // Apply the Gram-Schmidt Procedure to the given basis.
  var orth = [basis[0].getNormalized()], vector, vectorCopy, i, j;
  for (i = 1; i < basis.length; i++) {
    vector = basis[i].clone();
    vectorCopy = vector.clone();
    for (j = 0; j < i; j++) {
      vector.add(orth[j].getScaled( -vectorInner(vectorCopy, orth[j]) ));
    }
    orth.push(vector.getNormalized());
  }
  return orth;
}

function proj(f, orth) {
  var empty = [], i;
  for (i = 0; i < dimension; i++) {
    empty.push(0);
  }
  var v = new Vector(empty),
      intermediate = [];
  for (i = 0; i < dimension; i++) {
    v.add(orth[i].getScaled( inner(f, orth[i].toPolynomial()) ));
    intermediate.push(v.clone());
  }
  return intermediate;
}

function approximate(functionString) {
  steps = parseInt(get("steps").value);
  dimension = parseInt(get("dimension").value);
  lowerBound = parseInt(get("lowerBound").value);
  upperBound = parseInt(get("upperBound").value);
  var orth;
  if (dimension > 40 || lowerBound != -1 || upperBound != 1) {
    alert("Warning: custom approximations with degree greater than 40 take several minutes to compute. If the degree is greater than 100, you might want to close then reopen the tab.");
    orth = orthonormalize(getStandardBasis());
  }
  else {
    orth = orth40;
  }
  eval("var f = (x) => { " + (functionString.indexOf("return") == -1 ? "return " + functionString : functionString) + " };");
  var approximations = proj(f, orth),
      equationStr = approximations[approximations.length - 1].toString( parseInt(get("digits").value));
  get("approximation").textContent = equationStr;
  graph(approximations);
}

function graph(approximations) {
  get("graph").style.display = "block";
  get("graph").style.width = Math.floor(window.innerWidth * 0.75) + "px";
  get("graph").style.height = Math.floor(window.innerWidth * 0.5) + "px";
  var conditionalStr = "f(x) = \\{", digits = parseInt(get("digits").value);
  if (digits > 32) {
    digits = 32;
  }
  for (var i = 0; i < approximations.length; i++) {
    conditionalStr += "n = " + i + ": " + approximations[i].toString(digits) + (i < approximations.length - 1 ? ", " : "\\}");
  }
  calculator.setExpression({id: "function", latex: conditionalStr});
  calculator.setExpression({id: "degreeSlider", latex: "n = " + (approximations.length - 1), sliderBounds: {min: "0", max: (approximations.length - 1).toString(), step: "1"}});
}

var orth40 = [new Vector([1.00000000000000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([0.00173205167359497176,1.73205167359493072965,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-1.11803231169597649952,0.00670822070305768063,3.35411035152933711956,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-0.00396863887256344947,-3.96862564371196890889,0.01984327373590734703,6.61442457863352384351,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([1.12499437496062859587,-0.02250018750224089953,-11.25004125034877944245,0.05250078751050667181,13.12519687763816911286,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([0.00621871812282541892,6.21866008078446075302,-0.08706292435181528511,-29.02080065628648597453,0.13059569248456964763,26.11913849687381627973,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-1.12672294268689654473,0.04732368866211783542,23.66156038472302114428,-0.28394610723662283558,-70.98600623433826228847,0.31234509079202926740,52.05751513217160209024,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-0.00847226968378790232,-8.47211717988849777328,0.22875555160422414436,76.25073215344077937061,-0.83878601330548052672,-167.75574874197189956249,0.72696144814723195893,103.85163545163472065269,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([1.12739140055956066355,-0.08117607734488853366,-40.58714570172242730450,0.89295828198372062534,223.23570086580980387225,-2.32174725536057247055,-386.95400615691778511973,1.65843069898654693617,207.30383734302517950709,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([0.01072721922455499056,10.72690456308150963594,-0.47201180659553793051,-157.33317812642889066410,3.06816878963707839745,613.62148539821907888836,-6.13652167701393835841,-876.63601889608548844990,3.72585707998861348500,413.98412026723354983915,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-1.12771222307456930878,0.12405744280247466005,62.02657068692933961529,-2.15040785636277842485,-537.58583332072657867684,9.67719018287453103255,1612.82846565427098539658,-15.66840623040698865509,-1958.52596426098830306728,8.26973984269359441157,826.97398230666522067622,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-0.01298289405976026101,-12.98233164511262849317,0.84392525039843890866,281.29716735545918027128,-8.43962387330519447914,-1687.86739932908085393137,28.69598385421529940231,4099.32244254562465357594,-38.94626320820326270677,-4327.30202454886511986842,18.17572257704934202138,1652.33842671534262080968,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([1.12788570847882962944,-0.17596847406180923801,-87.97983605076768753861,4.39944059375718943272,1099.81027247972156146716,-29.91775163961074213148,-4986.10240908345076604746,81.20954854770450026535,10150.90925783382044755854,-94.74940006205073927958,-9474.79467239966652414296,39.62453678264682821464,3302.04471995537414841237,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([0.01523901832702381602,15.23810411894442218284,-1.37159489292866187959,-457.17238998095649549214,19.43210685602339182765,3886.22444800274388398975,-98.46198264993309123838,-14065.40669145126230432652,221.55290394109729845695,24616.23430024657864123583,-226.49004386028857993551,-20589.66074125498198554851,85.79688876622419968498,6599.76065390880194172496,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-1.12798406799294603786,0.23691055255621867870,118.44689316614363860936,-8.05552234776659759063,-2013.74805761604943654675,76.53281734904362565430,12754.72671739371253352147,-306.15269301824605463480,-38267.24813256011839257553,586.83372875515033229021,58681.30662843945901840925,-533.52254570719458115491,-44459.33465487244393443689,184.69380702664528826062,13192.39347762054421764333,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-0.01749531505169723070,-17.49420387371786844710,2.08211032962749476027,693.99343021885101734370,-39.56327544149830544029,-7912.19482663083545048721,276.96514366778637850075,39564.43774069461505860090,-910.10124858787332868815,-101118.25856229993223678321,1516.95687215972111516749,137901.38594616096816025674,-1241.24586985605219524587,-95479.35347465412633027881,395.59352098647855200397,26373.09180501673836261034,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([1.12827307669584953054,-0.30681525451815322425,-153.45265564362202326265,13.60334706036776353244,3401.73712676730110615608,-171.41750527411176108217,-28576.54924166885029990226,938.79940518915384473075,117376.87041050380503293127,-2608.01175981607639187132,-260858.91790161709650419652,3841.23794287578584771836,320173.12081546237459406257,-2856.56425083320345947868,-204085.31091878528241068125,843.44317037106623047293,52727.17061727773398160934,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([0.01978319598310592994,19.72463434521516845166,-3.00710621690968071817,-999.75439822654607269214,73.67770095812022645987,14701.24102434118140081409,-677.88031133660001614771,-96636.91344127117190510035,3026.49040764054097962799,335636.39738717389991506934,-7264.20863815570555743761,-659235.00260480178985744715,9576.43271368570276536047,735476.02364960056729614735,-6525.23023638208724150900,-434379.55369263654574751854,1794.61573944118094914302,105423.83204946358455345035,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-1.08150070287214594700,0.40203724596584583528,186.47199440038650664064,-22.52638078834810286821,-5257.01399484051762556192,362.81973519269337202786,56750.24069852750835707411,-2592.35745466278376625269,-305511.37034627585671842098,9723.67057040046711335890,920416.77581231878139078617,-20512.11604293754862737842,-1623682.24804856372065842152,24460.78468296290157013573,1664772.37302673002704977989,-15377.55062277721663122065,-918275.28425325429998338223,3957.96293669380793289747,210607.56554069678531959653,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-0.01372245622370041156,-26.89205333547466381106,2.63158692567316032651,1622.89045620294632499281,-81.48882754710432152478,-28755.29371800102671841159,956.96258885524764536967,231760.09529136939090676606,-5561.50430355057869746815,-1012360.32030457397922873497,17974.86480148062037187628,2598726.47722386103123426437,-33839.71579269607900641859,-4033171.84372360538691282272,36863.41983825391071150079,3720749.57728477381169795990,-21521.18663716873197699897,-1877477.53480989648960530758,5206.78846238225651177345,398936.81751933228224515915,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([1.12360234199381436859,0.24768184314899630016,-199.73164258715905816643,-16.58615257174378143645,5817.50289445846010494279,328.17182068106598080703,-65165.96852329075773013756,-2958.33981967340196206351,366718.00551007903413847089,14433.30979737090274284128,-1168861.98568138619884848595,-41250.74057455347792711109,2226161.00118982186540961266,70982.82757228345144540071,-2557290.06809582514688372612,-72271.94019919853599276394,1709801.22950040386058390141,40057.74882629091734997928,-596533.44447718013543635607,-9305.82037539439988904633,79546.24740609209402464330,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-0.04440380086025536022,-26.04235328221855283459,8.10705809854475312193,1576.39066467592806475295,-241.51295001368060866298,-27979.71115865043975645676,2754.45203759555397482472,225553.59957044789916835725,-15696.52602508133713854477,-983486.59657039586454629898,50306.66909076920273946598,2512813.29910547146573662758,-95373.35847114675561897457,-3863034.42525446647778153419,107325.08249906361743342131,3497002.31354022910818457603,-68282.12671865703305229545,-1690278.88110373285599052906,21263.73713419258638168685,309171.58567102131200954318,-2063.47853105873764434364,18692.91455299676817958243,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([1.14218077492846714627,0.89257310996546579407,-204.32454975463295454574,-55.56972590993961347294,5990.89433379099318699446,1018.97998742893980761437,-67589.66084581315226387233,-8516.80068845979440084193,383351.15158406732371076941,38619.15636254747369093820,-1232473.99072695756331086159,-102900.76383536696084775031,2369192.87860033474862575531,165508.77097292331745848060,-2745889.60733218770474195480,-157575.66687947703758254647,1843256.53407631511799991131,81119.45438034387188963592,-628532.51487185014411807060,-16750.83204406001459574327,65512.96528422673873137683,-468.81690229295907101914,7378.62046703669693670236,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-0.07810986653649536204,-25.32959077397027769507,14.14808907110548830133,1533.99064703234625994810,-418.90320719975915153555,-27212.22103382805289584212,4757.84011991078659775667,218979.20184027159120887518,-27064.36828889673051889986,-951661.36932006326969712973,86843.42113377431815024465,2418351.02019041497260332108,-165516.12500374001683667302,-3686280.63692911155521869659,188398.16312582444516010582,3292617.55737234652042388916,-122444.40408702779677696526,-1558239.19137145671993494034,39592.83639797398063819855,279136.88727343018399551511,-3963.41966186133777227951,6488.87863617391576553928,-197.88198129815359038730,6315.99869960582418570993,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([1.15183086982101379192,1.53279426867370127674,-206.59780803393900328047,-94.30462070943866592643,6073.97223042747373256134,1705.29194304522843594896,-68718.23461932432837784290,-14031.73511822984983155038,390862.02754032757366076112,62546.58201513558742590249,-1260133.88975677476264536381,-163586.50311353028519079089,2428300.89996720850467681885,257796.57080813735956326127,-2818308.40926554705947637558,-239765.79627643013373017311,1889158.62676718388684093952,119853.41293622346711345017,-638787.24365961889270693064,-23634.30839580061001470312,66233.99481825495604425669,-626.85949058262576727429,3409.49691802130882933852,-165.17474552189116820955,2108.40795636788152478402,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-0.11495426080821406767,-24.56410653836574908837,20.76526295547430933652,1487.06838586155595294258,-613.63167370092548935645,-26343.52696326869045151398,6962.06831631493059830973,211451.81899283203529193997,-39601.94730177268502302468,-915316.11803340492770075798,127238.91088953182043042034,2312513.47871083207428455353,-243245.33310539252124726772,-3495666.45116552663967013359,278381.83619516354519873857,3085288.64717356953769922256,-182523.66592973831575363874,-1435576.49256074451841413975,59795.43564740167494164780,252017.21810872937203384936,-6049.41147912181168067036,5697.43652554099480767036,-304.88135135907026551649,1208.01437941866379333078,-58.56471612982818442106,3268.58979822307719587116,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([1.15665807019866972993,2.16791971615381173777,-207.75305684676223449969,-132.72177850587090119916,6116.37755941872183029773,2385.11565819139696031925,-69291.77485547456308268011,-19481.15513963591365609318,394629.77993713534669950604,86097.10368761216523125768,-1273692.95119768986478447914,-222967.49926957249408587813,2456238.72790656425058841705,347334.71687232295516878366,-2850661.87224671617150306702,-318531.88835447159362956882,1907923.01348747033625841141,156326.43098072565044276416,-642440.00077183451503515244,-29981.92818134386834572069,66438.24482137328595854342,-768.39169232076835669432,3413.99990987769751882297,-194.49653964239760739474,667.98234894201164024707,-88.85709308311771792432,859.35602377491704828572,0,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-0.15625832160270777815,-23.61688110431067499917,28.19204881900498804725,1428.30978362913765522535,-832.43561492522178468789,-25248.81031772633650689386,9441.57355600660775962751,201970.46439694828586652875,-53719.97086893550294917077,-869907.32863669446669518948,172766.84541861873003654182,2182438.34148397762328386307,-330900.13350645225727930665,-3267259.03806218784302473068,379848.35545122285839170218,2845315.25292405439540743828,-250179.11223481627530418336,-1299401.21673616440966725349,82464.65152354906604159623,222390.52459275029832497239,-8384.76558944792850525118,4840.70082239843031857163,-424.48481799540314796104,964.26496487625126974308,-81.89312138853890132850,300.84761880757241669926,-24.93572721317597640223,2196.80847330702772524091,0,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([1.15833912146619066874,2.79614589237293298396,-208.22715082489540350252,-170.68364273068172565218,6135.19364535748445632635,3055.40384805399344259058,-69556.25094741133216302842,-24834.88519527047174051404,396390.84260919986991211772,109112.36254901153733953834,-1279984.12875966215506196022,-280569.25110183627111837268,2468810.37268868461251258850,433297.71252520370762795210,-2864289.91798567818477749825,-393072.28923022648086771369,1914749.59504318400286138058,190150.42235134204383939505,-643172.73655828426126390696,-35706.30992428094759816304,66411.09962307012756355107,-890.67743027120638998895,3408.95138270735014884849,-218.02736287127490300009,666.44710464770969338133,-95.63528978671590152771,205.60745995402771768568,-62.46964442753037616285,426.34507248780681720746,0,0,0,0,0,0,0,0,0,0,0]),
new Vector([-0.20586476767463984805,-22.22740799147844370509,37.11854913916201326174,1341.71835076301294975565,-1095.60378713626437274797,-23634.35177443625798332505,12425.54169322457892121747,188037.14432057467638514936,-70717.61625800885667558759,-803712.34505767421796917915,227592.34126080936403013766,1995203.88324411516077816486,-436441.68183310143649578094,-2944089.57464699819684028625,501939.60023275821004062891,2512949.04085457185283303261,-331466.43861415429273620248,-1115106.45335198612883687019,109631.25990680015820544213,182717.47761945519596338272,-11178.47092491208422870841,3701.22511805423255282221,-567.36912691518489282316,641.63879902428197965492,-109.73071684762824418158,136.50229460320443308774,-33.49499846685747428410,-28.52357529975416738921,-13.19212164101007545014,1870.88153693339654637384,0,0,0,0,0,0,0,0,0,0]),
new Vector([1.15760568945256880902,3.41332273049824497235,-208.20573108641224280291,-207.89993450432723420818,6137.56892331763901893282,3709.97899582798527262639,-69613.20549879137251991779,-30032.09115359993302263319,396850.67165504093281924725,131266.33347874711034819484,-1281722.68445583269931375980,-335369.59799801284680142999,2472094.65583867998793721199,513769.20398125954670831561,-2867007.45968482503667473793,-461288.62258310633478686213,1914821.18428378994576632977,220102.32904907345073297620,-642189.73069538350682705641,-40521.94361301471508340910,66242.09232056631299201399,-984.83410250178485512151,3397.80315045579618526972,-233.06121172415444675607,663.88546923231012897304,-97.83569638892195996505,204.71754585877954468742,-60.33925133616951086424,81.45851336413214482945,-56.71665061631257032104,240.49439735298679465814,0,0,0,0,0,0,0,0,0]),
new Vector([-0.27946500615636682419,-19.30176625723677474866,50.37097730473821144415,1159.23887361976221654913,-1486.49077394583900968428,-20239.24563249805942177773,16858.90135678392834961414,158885.14918928960105404258,-95972.53914011774759273976,-666320.90370501542929559946,309030.39204292383510619402,1610745.90499268518760800362,-593111.12756503641139715910,-2289226.79822234902530908585,682962.84236328536644577980,1849558.62032404402270913124,-451767.03198063297895714641,-752873.75109713245183229446,149732.64134237886173650622,105445.67509381075797136873,-15294.28944400372893142048,1497.09294923687025402614,-777.52593957791111733968,21.02381965435889554783,-150.61293049312172342979,-178.21118741638164806318,-46.04697024680883998826,-267.18819428874422783338,-18.16495713798263977878,-458.57534498073391660000,-8.45607130347721636099,2278.32935924838920982438,0,0,0,0,0,0,0,0]),
new Vector([1.15454943172203394752,3.99864789385710484027,-207.73108932658811909278,-242.98762169041248171197,6125.53742151874666888034,4320.74710506174051261041,-69495.04791908913466613740,-34806.13073169264680473134,396249.24154401267878711224,151165.98048089575604535639,-1279861.11611134582199156284,-383062.66838598373578861356,2468229.68805507570505142212,580704.43815437261946499348,-2861483.69564033485949039459,-514314.44095342326909303665,1909771.42001368571072816849,240949.18236391837126575410,-639793.56574499863199889660,-43220.52276844307198189199,65946.58874837549228686839,-1013.80579192897380380600,3380.81238358421705925139,-228.46679775942308765480,660.27308865579504981724,-89.48064716785040673130,203.52520894536291962140,-49.78244089335199618063,80.95592517804170995532,-39.66661611673869458627,38.00505102215427655210,-78.28151958457965520211,148.39707080236905767379,0,0,0,0,0,0,0]),
new Vector([-0.35674115607210554746,29.82019148789318307990,64.28584350899814126024,-1853.80152748328714551462,-1896.95974427826899955107,34257.41531688184477388859,21515.19615565223648445681,-291240.10125834547216072679,-122504.43725407998135779053,1355290.75730235455557703972,394616.44540432537905871868,-3736105.79911006009206175804,-757833.19244779646396636963,6258057.64014610089361667633,873389.58527859440073370934,-6226679.47495953738689422607,-578389.57095704332459717989,3338741.56322555569931864738,191966.41917100825230590999,-701098.28847951127681881189,-19632.07291853243077639490,-19711.47146381583297625184,-999.15435471910075193591,-5476.84614882642108568689,-193.75305792497644574723,-2743.77294724158491590060,-59.30044093468218591170,-2057.95133013053055037744,-23.41909163028044815746,-2407.28256999282712058630,-10.91426645764218505974,-8261.35952115442159993108,-5.70074023039360788800,11266.91156872093415586278,0,0,0,0,0,0]),
new Vector([1.15874430373327919064,2.80104590842796152828,-208.53935775772421834517,-168.63949776888850351497,6150.70561835846274334472,2949.91956271804428979522,-69792.07392485730815678835,-23187.15335260268693673424,397979.96583732229191809893,97293.93289528641616925597,-1285444.24749419395811855793,-235168.34334240847965702415,2478643.98133801203221082687,334089.58452504285378381610,-2872611.26901997392997145653,-270093.85780028777662664652,1916104.79894939367659389973,110633.42248310026479884982,-641392.84449116874020546675,-15990.19929834419963299297,66074.46268679916101973504,-251.89418845067189067777,3385.91640948718440995435,-17.73985481832705346505,661.03112015664930822822,15.63310957119113808744,203.69326755303512754836,28.74140563489235944417,80.99873791824833801911,51.84778377527420190063,38.01454636151713373238,234.72428641440450292066,19.99851032996671307274,-424.93301366080089565003,98.67552189489782676901,0,0,0,0,0]),
new Vector([0.49898871772731656637,-23.39926904386313211148,-89.90644342700147717551,1466.97449224610681994818,2652.83708124175154807745,-27471.43677432764161494561,-30089.74077560063233249821,237608.17200043614138849080,171354.40323627614998258650,-1128299.69896120810881257057,-552135.76663852017372846603,3180473.74692064104601740837,1060808.40394862298853695393,-5454423.63932331185787916183,-1223313.90350878192111849785,5560305.62472602538764476776,810766.49671244050841778517,-3055630.45930892787873744965,-269346.49437045294325798750,657856.11164300690870732069,27567.91486036074638832361,18946.06738010507615399547,1404.12223387273320440727,5385.13265951434004819021,272.49152432011925384359,2755.53236448820507575874,83.46387192239924956993,2107.52943665144130136468,32.98785217397606572831,2509.78499224307824988500,15.38617821683457087545,8754.76923493858885194641,8.04320885881093694536,-13206.18278294339324929751,4.63722896143727503215,875.35100217128297117597,0,0,0,0]),
new Vector([1.15858696345718392706,1.65274103600248278845,-208.55110504133472204558,-96.84781407196683744587,6151.98609453754397691227,1611.45653124355885665864,-69813.64716576764476485550,-11676.96071851917986350600,398116.81958478799788281322,43003.27397213637595996261,-1285819.14594903052784502506,-83250.31963968985655810684,2478953.93773369165137410164,75533.54446392126556020230,-2872067.38606534525752067566,-8533.95074514949192234781,1914795.82033101143315434456,-32024.49105825060905772261,-640530.52678333129733800888,14499.22838185488581075333,65954.38572430575732141733,620.22724011064133264881,3378.48239096003499071230,228.60743659152601026108,659.36131954707002478244,140.98061131403292733921,203.11693111890210161619,124.13170357287233969146,80.74636739060794354828,164.94099393755044502541,37.88566547482281521297,627.68195850870620233763,19.92539142588262990330,-1015.66608652780996635556,11.55924438636309226069,39.96093430296604509522,68.46974022849120444789,0,0,0]),
new Vector([0.57027745808041674369,-19.50004389495752477046,-102.74156908964749845836,1229.36400047242523214663,3031.47919761285857020994,-23222.38526310541783459485,-34386.11483991140994476154,203080.92563032594625838101,195846.88467775878962129354,-976534.20330525527242571115,-631197.01541868003550916910,2789815.37401218106970191002,1213109.40800957242026925087,-4850354.90774442348629236221,-1399575.54881028551608324051,5012014.72208690736442804337,928118.34649752057157456875,-2790956.67990765860304236412,-308539.96464214200386777520,608636.33943122078198939562,31597.97504147292420384474,17738.44526602666519465856,1610.29069281954798498191,5096.82559234343716525473,312.67673805403217102139,2633.59259462077943680924,95.82701747987064777590,2031.93206965395415863895,37.89623804021249497964,2438.64973723309913111734,17.68610545915974441300,8565.59194102636320167221,9.25118748863862450094,-13000.22267787614691769704,5.33704601248755494680,485.68936366455784536811,3.22989914583887394173,309.97289721657978134317,0,0]),
new Vector([1.15551791071897458352,0.70881690291582322150,-208.02836299446857992734,-37.57989525184115109369,6137.21909681567194638774,499.04918563621919247453,-69650.35314786719391122460,-2028.12045621501488312788,397187.52437026670668274164,-2962.92001692634858045494,-1282731.17705451464280486107,46769.43174615936004556715,2472606.51060525747016072273,-148248.13565977578400634229,-2863929.09283123025670647621,220426.20157007069792598486,1908592.85751654533669352531,-158315.47850980845396406949,-638120.59464587108232080936,41793.57018959806737257168,65680.88339440856361761689,1409.22610406105263791687,3363.40441339019071165239,453.65918394497396093357,656.23257214317743546417,256.51793928157451318839,202.09962898616521442818,212.77004344681952829887,80.32162488446044790180,270.79787991314213968508,37.67713570495328667675,997.91162896239984547719,19.81096870705767898357,-1575.50639957798171053582,11.49015895687395705238,60.81050330530428738030,6.99173879956996291440,14.14275206730892975315,49.44252883605889792307,0]),
new Vector([0.61933199833049878968,-16.90383379772347893777,-111.57241189963943384100,1070.36472501276443836105,3292.00222128869654625305,-20355.77970125346837448888,-37342.84857668176846345887,179519.75650673988275229931,212709.32934635726269334555,-871421.41986308339983224869,-685662.40743516583461314440,2514171.24651330104097723961,1318118.38990156725049018860,-4414296.23218379076570272446,-1521235.73149678413756191730,4605042.24968012049794197083,1009222.36710715864319354296,-2587654.69618259835988283157,-335666.56561306974617764354,569157.34641199163161218166,34390.97368653282319428399,16717.23443809471427812241,1753.36023563286516946391,4836.81933153501358901849,340.59975863274240737155,2514.61913973775472186389,104.42919204327748161631,1950.63820467236860167759,41.31615571673700770816,2352.19789826901887863642,19.29084322880569857261,8296.30441238794446690008,10.09525580156762103456,-12637.41396283203357597813,5.82676424323735986377,473.64387829515140992953,3.52799533037737367280,107.52364006092879833432,2.24256339490763512146,161.95451619387591790655])
];
